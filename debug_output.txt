Checking HR Accuracy with EdgeFace XXS...
[EdgeFace] Attempting TorchScript load from edgeface_xxs.pt
[EdgeFace] TorchScript load failed: PytorchStreamReader failed locating file constants.pkl: file not found
[EdgeFace] Falling back to architecture loading
[EdgeFace] Detected ConvNeXt-XXS (edgeface_xxs) architecture
[EdgeFace] Missing keys: 160
[EdgeFace]   ['core.model.stem.0.weight', 'core.model.stem.0.bias', 'core.model.stem.1.weight', 'core.model.stem.1.bias', 'core.model.stages.0.blocks.0.gamma', 'core.model.stages.0.blocks.0.conv_dw.weight', 'core.model.stages.0.blocks.0.conv_dw.bias', 'core.model.stages.0.blocks.0.norm.weight', 'core.model.stages.0.blocks.0.norm.bias', 'core.model.stages.0.blocks.0.mlp.fc1.weight', 'core.model.stages.0.blocks.0.mlp.fc1.bias', 'core.model.stages.0.blocks.0.mlp.fc2.weight', 'core.model.stages.0.blocks.0.mlp.fc2.bias', 'core.model.stages.0.blocks.1.gamma', 'core.model.stages.0.blocks.1.conv_dw.weight', 'core.model.stages.0.blocks.1.conv_dw.bias', 'core.model.stages.0.blocks.1.norm.weight', 'core.model.stages.0.blocks.1.norm.bias', 'core.model.stages.0.blocks.1.mlp.fc1.weight', 'core.model.stages.0.blocks.1.mlp.fc1.bias', 'core.model.stages.0.blocks.1.mlp.fc2.weight', 'core.model.stages.0.blocks.1.mlp.fc2.bias', 'core.model.stages.1.downsample.0.weight', 'core.model.stages.1.downsample.0.bias', 'core.model.stages.1.downsample.1.weight', 'core.model.stages.1.downsample.1.bias', 'core.model.stages.1.blocks.0.gamma', 'core.model.stages.1.blocks.0.conv_dw.weight', 'core.model.stages.1.blocks.0.conv_dw.bias', 'core.model.stages.1.blocks.0.norm.weight', 'core.model.stages.1.blocks.0.norm.bias', 'core.model.stages.1.blocks.0.mlp.fc1.weight', 'core.model.stages.1.blocks.0.mlp.fc1.bias', 'core.model.stages.1.blocks.0.mlp.fc2.weight', 'core.model.stages.1.blocks.0.mlp.fc2.bias', 'core.model.stages.1.blocks.1.gamma_xca', 'core.model.stages.1.blocks.1.gamma', 'core.model.stages.1.blocks.1.convs.0.weight', 'core.model.stages.1.blocks.1.convs.0.bias', 'core.model.stages.1.blocks.1.pos_embd.token_projection.weight', 'core.model.stages.1.blocks.1.pos_embd.token_projection.bias', 'core.model.stages.1.blocks.1.norm_xca.weight', 'core.model.stages.1.blocks.1.norm_xca.bias', 'core.model.stages.1.blocks.1.xca.temperature', 'core.model.stages.1.blocks.1.xca.qkv.weight', 'core.model.stages.1.blocks.1.xca.qkv.bias', 'core.model.stages.1.blocks.1.xca.proj.weight', 'core.model.stages.1.blocks.1.xca.proj.bias', 'core.model.stages.1.blocks.1.norm.weight', 'core.model.stages.1.blocks.1.norm.bias', 'core.model.stages.1.blocks.1.mlp.fc1.weight', 'core.model.stages.1.blocks.1.mlp.fc1.bias', 'core.model.stages.1.blocks.1.mlp.fc2.weight', 'core.model.stages.1.blocks.1.mlp.fc2.bias', 'core.model.stages.2.downsample.0.weight', 'core.model.stages.2.downsample.0.bias', 'core.model.stages.2.downsample.1.weight', 'core.model.stages.2.downsample.1.bias', 'core.model.stages.2.blocks.0.gamma', 'core.model.stages.2.blocks.0.conv_dw.weight', 'core.model.stages.2.blocks.0.conv_dw.bias', 'core.model.stages.2.blocks.0.norm.weight', 'core.model.stages.2.blocks.0.norm.bias', 'core.model.stages.2.blocks.0.mlp.fc1.weight', 'core.model.stages.2.blocks.0.mlp.fc1.bias', 'core.model.stages.2.blocks.0.mlp.fc2.weight', 'core.model.stages.2.blocks.0.mlp.fc2.bias', 'core.model.stages.2.blocks.1.gamma', 'core.model.stages.2.blocks.1.conv_dw.weight', 'core.model.stages.2.blocks.1.conv_dw.bias', 'core.model.stages.2.blocks.1.norm.weight', 'core.model.stages.2.blocks.1.norm.bias', 'core.model.stages.2.blocks.1.mlp.fc1.weight', 'core.model.stages.2.blocks.1.mlp.fc1.bias', 'core.model.stages.2.blocks.1.mlp.fc2.weight', 'core.model.stages.2.blocks.1.mlp.fc2.bias', 'core.model.stages.2.blocks.2.gamma', 'core.model.stages.2.blocks.2.conv_dw.weight', 'core.model.stages.2.blocks.2.conv_dw.bias', 'core.model.stages.2.blocks.2.norm.weight', 'core.model.stages.2.blocks.2.norm.bias', 'core.model.stages.2.blocks.2.mlp.fc1.weight', 'core.model.stages.2.blocks.2.mlp.fc1.bias', 'core.model.stages.2.blocks.2.mlp.fc2.weight', 'core.model.stages.2.blocks.2.mlp.fc2.bias', 'core.model.stages.2.blocks.3.gamma', 'core.model.stages.2.blocks.3.conv_dw.weight', 'core.model.stages.2.blocks.3.conv_dw.bias', 'core.model.stages.2.blocks.3.norm.weight', 'core.model.stages.2.blocks.3.norm.bias', 'core.model.stages.2.blocks.3.mlp.fc1.weight', 'core.model.stages.2.blocks.3.mlp.fc1.bias', 'core.model.stages.2.blocks.3.mlp.fc2.weight', 'core.model.stages.2.blocks.3.mlp.fc2.bias', 'core.model.stages.2.blocks.4.gamma', 'core.model.stages.2.blocks.4.conv_dw.weight', 'core.model.stages.2.blocks.4.conv_dw.bias', 'core.model.stages.2.blocks.4.norm.weight', 'core.model.stages.2.blocks.4.norm.bias', 'core.model.stages.2.blocks.4.mlp.fc1.weight', 'core.model.stages.2.blocks.4.mlp.fc1.bias', 'core.model.stages.2.blocks.4.mlp.fc2.weight', 'core.model.stages.2.blocks.4.mlp.fc2.bias', 'core.model.stages.2.blocks.5.gamma_xca', 'core.model.stages.2.blocks.5.gamma', 'core.model.stages.2.blocks.5.convs.0.weight', 'core.model.stages.2.blocks.5.convs.0.bias', 'core.model.stages.2.blocks.5.convs.1.weight', 'core.model.stages.2.blocks.5.convs.1.bias', 'core.model.stages.2.blocks.5.norm_xca.weight', 'core.model.stages.2.blocks.5.norm_xca.bias', 'core.model.stages.2.blocks.5.xca.temperature', 'core.model.stages.2.blocks.5.xca.qkv.weight', 'core.model.stages.2.blocks.5.xca.qkv.bias', 'core.model.stages.2.blocks.5.xca.proj.weight', 'core.model.stages.2.blocks.5.xca.proj.bias', 'core.model.stages.2.blocks.5.norm.weight', 'core.model.stages.2.blocks.5.norm.bias', 'core.model.stages.2.blocks.5.mlp.fc1.weight', 'core.model.stages.2.blocks.5.mlp.fc1.bias', 'core.model.stages.2.blocks.5.mlp.fc2.weight', 'core.model.stages.2.blocks.5.mlp.fc2.bias', 'core.model.stages.3.downsample.0.weight', 'core.model.stages.3.downsample.0.bias', 'core.model.stages.3.downsample.1.weight', 'core.model.stages.3.downsample.1.bias', 'core.model.stages.3.blocks.0.gamma', 'core.model.stages.3.blocks.0.conv_dw.weight', 'core.model.stages.3.blocks.0.conv_dw.bias', 'core.model.stages.3.blocks.0.norm.weight', 'core.model.stages.3.blocks.0.norm.bias', 'core.model.stages.3.blocks.0.mlp.fc1.weight', 'core.model.stages.3.blocks.0.mlp.fc1.bias', 'core.model.stages.3.blocks.0.mlp.fc2.weight', 'core.model.stages.3.blocks.0.mlp.fc2.bias', 'core.model.stages.3.blocks.1.gamma_xca', 'core.model.stages.3.blocks.1.gamma', 'core.model.stages.3.blocks.1.convs.0.weight', 'core.model.stages.3.blocks.1.convs.0.bias', 'core.model.stages.3.blocks.1.convs.1.weight', 'core.model.stages.3.blocks.1.convs.1.bias', 'core.model.stages.3.blocks.1.convs.2.weight', 'core.model.stages.3.blocks.1.convs.2.bias', 'core.model.stages.3.blocks.1.norm_xca.weight', 'core.model.stages.3.blocks.1.norm_xca.bias', 'core.model.stages.3.blocks.1.xca.temperature', 'core.model.stages.3.blocks.1.xca.qkv.weight', 'core.model.stages.3.blocks.1.xca.qkv.bias', 'core.model.stages.3.blocks.1.xca.proj.weight', 'core.model.stages.3.blocks.1.xca.proj.bias', 'core.model.stages.3.blocks.1.norm.weight', 'core.model.stages.3.blocks.1.norm.bias', 'core.model.stages.3.blocks.1.mlp.fc1.weight', 'core.model.stages.3.blocks.1.mlp.fc1.bias', 'core.model.stages.3.blocks.1.mlp.fc2.weight', 'core.model.stages.3.blocks.1.mlp.fc2.bias', 'core.model.head.norm.weight', 'core.model.head.norm.bias', 'core.model.head.fc.weight', 'core.model.head.fc.bias']
[EdgeFace] Unexpected keys: 160
[EdgeFace]   ['stem.0.weight', 'stem.0.bias', 'stem.1.weight', 'stem.1.bias', 'stages.0.blocks.0.gamma', 'stages.0.blocks.0.conv_dw.weight', 'stages.0.blocks.0.conv_dw.bias', 'stages.0.blocks.0.norm.weight', 'stages.0.blocks.0.norm.bias', 'stages.0.blocks.0.mlp.fc1.weight', 'stages.0.blocks.0.mlp.fc1.bias', 'stages.0.blocks.0.mlp.fc2.weight', 'stages.0.blocks.0.mlp.fc2.bias', 'stages.0.blocks.1.gamma', 'stages.0.blocks.1.conv_dw.weight', 'stages.0.blocks.1.conv_dw.bias', 'stages.0.blocks.1.norm.weight', 'stages.0.blocks.1.norm.bias', 'stages.0.blocks.1.mlp.fc1.weight', 'stages.0.blocks.1.mlp.fc1.bias']
Device: cuda
pairs.txt not found, using manual pairs
Device: cuda
Dataset directory: A:\Programming\School\cs565\project\technical\dataset
Output directory: A:\Programming\School\cs565\project\technical\evaluation_results
Loaded 203 LFW subjects from A:\Programming\School\cs565\project\technical\dataset\frontal_only\test\hr_images
Loaded 203 subjects
Generated 200 pairs
Running inference on 200 pairs...
Img1 Stats: Mean=0.3698, Std=0.2418, Min=0.0000, Max=1.0000
Img1 Shape: torch.Size([1, 3, 112, 112])
0/200: Label=genuine, Score=0.8430
20/200: Label=genuine, Score=0.8807
40/200: Label=genuine, Score=0.7827
60/200: Label=genuine, Score=-0.0278
80/200: Label=genuine, Score=0.9398
100/200: Label=impostor, Score=0.8382
120/200: Label=impostor, Score=0.9084
140/200: Label=impostor, Score=0.4509
160/200: Label=impostor, Score=0.7195
180/200: Label=impostor, Score=0.8107

Best Accuracy: 65.50% at threshold 0.82
